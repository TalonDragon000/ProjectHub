# ProjectHub Development Log - v0.1.2

**Release Date:** December 18, 2025
**Status:** Bug Fix & Stability Update

---

## Overview

Version 0.1.2 is a maintenance release focused on resolving critical bugs discovered after the v0.1.1 gamification rollout. This update addresses project creation workflow issues, hero image persistence problems, and review/feedback submission failures across both authenticated and anonymous user flows.

---

## üêõ Bug Fixes

### 1. Creator View Not Updating After Initial Project Creation

**Issue:**
When users published their first project, the Dashboard creator view did not automatically refresh to reflect the new project. Users had to manually navigate away and back or refresh the page to see their newly created project appear in their creator dashboard.

**Root Cause:**
The `is_creator` flag was being set via database trigger after project creation, but the frontend profile state was not being refreshed to reflect this change. Additionally, the creator dashboard wasn't reloading project data after successful project creation.

**Fix:**
- Added `refreshProfile()` call after successful project publication
- Enhanced `loadCreatorData()` to be triggered automatically when `is_creator` flag changes
- Updated AuthContext to properly handle creator status transitions
- Dashboard now correctly re-renders when user becomes a creator for the first time

**Files Modified:**
- `src/contexts/AuthContext.tsx` - Added profile refresh mechanism
- `src/pages/Dashboard.tsx` - Enhanced creator data loading logic
- `src/pages/ProjectForm.tsx` - Added profile refresh on publish

---

### 2. Project Hero Banner Image Not Saving

**Issue:**
Hero images uploaded during project creation were not persisting to the database. After saving and navigating to the project page, no hero image would display despite successful upload confirmation during the form submission.

**Root Cause:**
- Hero image URL was being cleared between form steps
- Database insert/update operations were not including the `hero_image` field in all save operations
- Step-by-step save logic had inconsistent field inclusion across different save functions

**Fix:**
- Ensured `hero_image` field is included in all project INSERT and UPDATE operations
- Added persistence checks in `saveStep1()`, `saveStep2()`, and `saveStep3()` functions
- Hero image URL now properly maintained throughout multi-step form submission
- Added validation to ensure hero image URLs are included when publishing projects

**Files Modified:**
- `src/pages/ProjectForm.tsx` - Fixed hero image persistence across all save operations

---

### 3. Review and Feedback Submissions Not Posting

**Issue:**
Both authenticated users and anonymous users were unable to submit reviews and quick feedback. The submit buttons appeared to work (loading states activated) but no data was being saved to the database. Console showed no errors, making this a silent failure.

**Root Cause:**
- RLS (Row Level Security) policy conflicts introduced in v0.1.1 migrations
- Anonymous posting policies were too restrictive after session tracking implementation
- `session_id` field requirements conflicting with legacy anonymous submission flow
- Missing policy for INSERT operations with `post_reviews_anonymously` and `post_feedback_anonymously` flags

**Fix:**
- Updated RLS policies for `reviews` table to properly handle both authenticated and anonymous submissions
- Fixed `quick_feedback` table policies to allow INSERT with nullable `user_id`
- Added proper `session_id` generation for anonymous users in frontend
- Ensured `post_reviews_anonymously` preference doesn't block submission when user is logged in
- Verified XP triggers don't block INSERT operations

**Files Modified:**
- `supabase/updated schema/sec3_rls_policies.sql` - Fixed review and feedback INSERT policies
- `src/components/ReviewForm.tsx` - Added session ID handling for anonymous submissions
- `src/components/IdeaFeedback.tsx` - Fixed feedback submission flow

---

## üîÑ Known Issues & Planned Fixes

### Profile Views Should Track Unique Users

**Issue:**
Profile view counts currently increment on every page load rather than tracking unique visitors. This inflates view statistics and doesn't provide accurate engagement metrics.

**Planned Fix (v0.1.3):**
- Create `profile_views` table similar to `demo_views` structure
- Add unique constraints on `(profile_id, viewer_profile_id)` and `(profile_id, viewer_session_id)`
- Implement `record_profile_view()` RPC function
- Update ProfilePage component to call tracking function on mount
- Add profile view analytics to creator dashboard

**Status:** Scheduled for v0.1.3

---

## üìä Technical Details

### Database Changes

**No schema migrations required for this release** - all fixes were implemented via:
- RLS policy updates (applied directly to existing policies)
- Frontend logic improvements
- State management enhancements

### RLS Policy Updates

Updated policies on the following tables:
- `reviews` - Allow INSERT for authenticated users with proper anonymity handling
- `reviews` - Allow INSERT for anonymous users with valid session ID
- `quick_feedback` - Fixed INSERT policy to allow nullable `user_id`
- `quick_feedback` - Added session-based INSERT permissions

---

## üß™ Testing & Validation

### Manual Testing Completed

‚úÖ **Project Creation Flow**
- New user creates first project ‚Üí becomes creator ‚Üí dashboard updates immediately
- Existing creator publishes project ‚Üí appears in creator dashboard instantly

‚úÖ **Hero Image Upload**
- Upload during project creation ‚Üí persists to project page
- Upload during project edit ‚Üí updates properly
- Navigate away and return ‚Üí image still displays

‚úÖ **Review Submission**
- Logged in user submits review ‚Üí saves successfully
- Logged in user submits anonymous review ‚Üí saves with session ID
- Anonymous user submits review ‚Üí saves with session ID
- Public identity toggle ‚Üí XP updates correctly

‚úÖ **Feedback Submission**
- Logged in user submits feedback ‚Üí saves and increments validation count
- Logged in user submits anonymous feedback ‚Üí saves without user attribution
- Anonymous user submits feedback ‚Üí saves with session ID
- Feedback reactions ‚Üí counts update correctly

---

## üöÄ Performance & Security

### No Performance Regressions
- RLS policy optimizations maintained
- Index usage unchanged
- Query performance stable

### Security Maintained
- Anonymous submission security preserved
- Session ID validation enforced
- User data isolation intact
- XP farming prevention still active

---

## üìà Statistics

- **Bug Fixes:** 3 critical issues resolved
- **Files Modified:** 5 files
- **RLS Policies Updated:** 4 policies
- **New Migrations:** 0 (policy updates only)
- **Breaking Changes:** None

---

## üîó Related Documentation

- [v0.1.1 Devlog](./v0.1.1.md) - XP & Gamification System
- [v0.1.0 Devlog](./v0.1.0.md) - Foundation & Core Features
- [README.md](../README.md) - Project Overview
- [Database Schema](../supabase/updated%20schema/) - Complete SQL Structure

---

## ü§ù Contributors

Special thanks to early testers who reported these issues promptly.

**Development Team:**
- talondragon000 (Lead Developer)

---

*Last Updated: December 20, 2025*